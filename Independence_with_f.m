%% Independence of statistical results with factor f (honeybee study)
clc; 
clear all; close all;

%% Model 1 - deltay with rref regions
stat_coeffs1 = [0.50 0.11182246 0.03953073 0.01676750
 0.75 0.10293267 0.03046189 0.02535496
 1.00 0.08393694 0.02928214 0.03743779
 1.25 0.07848794 0.02809078 0.03357206
 1.50 0.06857939 0.03068781 0.03346642
 1.75 0.07142972 0.03529504 0.02930434
 2.00 0.06652295 0.03055866 0.02632645
 2.25 0.06575985 0.02577940 0.03000351
2.50 0.06295578 0.02079898 0.02927699]; 
                
se1=[0.50 0.014507103 0.021831653 0.022858512
 0.75 0.014807263 0.015893727 0.016406889
 1.00 0.009857731 0.011610977 0.011702933
 1.25 0.006791166 0.010077797 0.010020327
 1.50 0.005689854 0.008386944 0.008196155
 1.75 0.006319517 0.008008314 0.007902154
 2.00 0.004810881 0.006178974 0.006161645
 2.25 0.004602277 0.005712806 0.005641207
 2.50 0.003498265 0.004920692 0.004789705];

figure;
tiledlayout(2,2);

nexttile
errorbar(stat_coeffs1(:,1),stat_coeffs1(:,2), 1.96*se1(:,2),'Linewidth',2)
% ylim([-1.3 -0.8]);
% yticks([-1.3:0.25:-0.8]);
ylabel('alpha', 'FontSize', 16);
set(gca, 'FontSize', 16);

nexttile
errorbar(stat_coeffs1(:,1),stat_coeffs1(:,3), 1.96*se1(:,3),'Linewidth',2)
% ylim([-1 -0.6]);
% yticks([-1:0.2:-0.6]);
ylabel('beta1', 'FontSize', 16);
set(gca, 'FontSize', 16);

nexttile
errorbar(stat_coeffs1(:,1),stat_coeffs1(:,4), 1.96*se1(:,4),'Linewidth',2)
% ylim([-0.2 0.5]);
% yticks([-0.2:0.35:0.5]);
ylabel('beta2', 'FontSize', 16);
set(gca, 'FontSize', 16);

xlabel('factor f', 'FontSize', 16);

%% Model 2 - deltar with rref
stat_coeffs2 = [0.50 0.6662652 -0.19876567
 0.75 0.7695995 -0.06706759
 1.00 1.2005978 -0.34666249
 1.25 1.0962231 -0.32444054
 1.50 1.3586872 -0.43259823
 1.75 1.1208803 -0.35272336
 2.00 0.9421734 -0.28598780
 2.25 1.0609179 -0.32913737
 2.50 1.0825623 -0.33189334]; 
                
se2=[0.50 0.4189685 0.15629342
 0.75 0.4725260 0.11302286
 1.00 0.3907402 0.14550731
 1.25 0.2705300 0.09746294
 1.50 0.2351866 0.08495744
 1.75 0.1952477 0.06990574
 2.00 0.1728430 0.06114378
 2.25 0.1593170 0.05612981
2.50 0.1477494 0.05169772];

figure;
tiledlayout(1,2);

nexttile
errorbar(stat_coeffs2(:,1),stat_coeffs2(:,2), 1.96*se2(:,2),'Linewidth',2)
% ylim([-1.3 -0.8]);
% yticks([-1.3:0.25:-0.8]);
ylabel('alpha', 'FontSize', 16);
set(gca, 'FontSize', 16);

nexttile
errorbar(stat_coeffs2(:,1),stat_coeffs2(:,3), 1.96*se2(:,3),'Linewidth',2)
% ylim([-1 -0.6]);
% yticks([-1:0.2:-0.6]);
ylabel('beta1', 'FontSize', 16);
set(gca, 'FontSize', 16);

xlabel('factor f', 'FontSize', 16);
%% Model 3 - log(rref) vs log(y) and patterns

stat_coeffs = [0.50 0.5215187  0.088008389  0.075162157  0.12922029 -0.03733396  0.0334000439 0.1590100  0.13783400  0.21975286  0.1899696 -0.3429228
 0.75 0.5667550 -0.033082402  0.046617738  0.06127693 -0.08008204 -0.0304240110 0.1447900  0.02202884  0.13046267  0.2200257 -0.3671732
 1.00 0.5767402 -0.096769287  0.109207176  0.03669163  0.05987360  0.0257349520 0.1323769  0.11141997  0.15259599  0.2500383 -0.3120457
 1.25 0.6307618 -0.063221538  0.127617786 -0.01989329  0.15986109  0.0261864343 0.1389188  0.14832330  0.15611857  0.2570218 -0.2695738
 1.50 0.6617512 -0.045383590  0.141589797  0.04418134  0.13968630  0.0303646441 0.1351334  0.11207632  0.17086640  0.2647101 -0.2579203
 1.75 0.6977121 -0.028134476  0.145631697  0.04728481  0.13519579  0.0216562230 0.1150548  0.09148304  0.16276649  0.2535587 -0.2324182
 2.00 0.7385453 -0.033330984  0.131910214  0.04378861  0.12154910  0.0141067667 0.1135403  0.07719256  0.16639565  0.2068444 -0.2015783
 2.25 0.7361755  0.012570767  0.137523576  0.08448787  0.11589233  0.0004664714 0.1286706  0.07665992  0.16326052  0.2042729 -0.1964924
 2.50 0.7326976  0.009954004  0.127343564  0.12191962  0.13084755 -0.0007414156 0.1431801  0.06564761  0.15902178  0.2044068 -0.2030852]; 
                
se=[0.50 0.10880598 0.11847273 0.09204863 0.11032108 0.14586400 0.07506045 0.09623163 0.09069046 0.08628638  0.12888839  0.06852010
 0.75 0.09713988 0.08116217 0.06546713 0.09288536 0.09053062 0.05614813 0.06953104 0.06449325 0.05959469  0.08448186  0.04204110
 1.00 0.07370254 0.07796337 0.06433181 0.08802422 0.08735382 0.05378709 0.07011632 0.06271740 0.06026817  0.07752937  0.03704581
 1.25 0.07248413 0.06685673 0.05929133 0.08093820 0.07937894 0.05094857 0.06500654 0.05551237 0.05707269  0.07267735  0.03270149
 1.50 0.07479683 0.06301552 0.05526689 0.07159774 0.07548606 0.04701457 0.06080341 0.05126571 0.05120670  0.06967195  0.02902028
 1.75 0.07167339 0.05801947 0.05102242 0.06749068 0.06930903 0.04369036 0.05421695 0.04649112 0.04727463  0.06591714  0.02631399
 2.00 0.06442952 0.05747281 0.04865152 0.06296743 0.06596280 0.04173348 0.05391786 0.04484614 0.04492789  0.06179653  0.02406826
 2.25 0.06013833 0.05482826 0.04746519 0.05985924 0.06553642 0.04030312 0.05239847 0.04371346 0.04368711  0.05737484  0.02242822
 2.50 0.06148333 0.05252887 0.04632404 0.05730135 0.06096334 0.03904103 0.05082198 0.04202632 0.04192743  0.05725164  0.02175328];

figure;
tiledlayout(6,2);

nexttile
errorbar(stat_coeffs(:,1),stat_coeffs(:,2), 1.96*se(:,2),'Linewidth',2)
% ylim([-1.3 -0.8]);
% yticks([-1.3:0.25:-0.8]);
ylabel('alpha', 'FontSize', 16);
set(gca, 'FontSize', 16);

nexttile
errorbar(stat_coeffs(:,1),stat_coeffs(:,3), 1.96*se(:,3),'Linewidth',2)
% ylim([-1 -0.6]);
% yticks([-1:0.2:-0.6]);
ylabel('beta1', 'FontSize', 16);
set(gca, 'FontSize', 16);

nexttile
errorbar(stat_coeffs(:,1),stat_coeffs(:,4), 1.96*se(:,4),'Linewidth',2)
% ylim([-0.2 0.5]);
% yticks([-0.2:0.35:0.5]);
ylabel('beta2', 'FontSize', 16);
set(gca, 'FontSize', 16);

nexttile
errorbar(stat_coeffs(:,1),stat_coeffs(:,5), 1.96*se(:,5),'Linewidth',2)
% ylim([-0.1 0.2]);
% yticks([-0.1:0.15:0.2]);
ylabel('beta3', 'FontSize', 16);
set(gca, 'FontSize', 16);

nexttile
errorbar(stat_coeffs(:,1),stat_coeffs(:,6), 1.96*se(:,6),'Linewidth',2)
% ylim([0.1 0.3]);
% yticks([0.1 0.2 0.3]);
ylabel('beta4', 'FontSize', 16);
set(gca, 'FontSize', 16);

nexttile
errorbar(stat_coeffs(:,1),stat_coeffs(:,7), 1.96*se(:,7),'Linewidth',2)
% ylim([-0.6 0]);
% yticks([-0.6:0.3:0]);
ylabel('beta5', 'FontSize', 16);
set(gca, 'FontSize', 16);

nexttile
errorbar(stat_coeffs(:,1),stat_coeffs(:,8), 1.96*se(:,8),'Linewidth',2)
% ylim([-0.4 0]);
% yticks([-0.4:0.2:0]);
ylabel('beta6', 'FontSize', 16);
set(gca, 'FontSize', 16);

nexttile
errorbar(stat_coeffs(:,1),stat_coeffs(:,9), 1.96*se(:,9),'Linewidth',2)
% ylim([-0.1 0.2]);
% yticks([-0.1:0.15:0.2]);
ylabel('beta7', 'FontSize', 16);
set(gca, 'FontSize', 16);

nexttile
errorbar(stat_coeffs(:,1),stat_coeffs(:,10), 1.96*se(:,9),'Linewidth',2)
% ylim([-0.1 0.2]);
% yticks([-0.1:0.15:0.2]);
ylabel('beta8', 'FontSize', 16);
set(gca, 'FontSize', 16);

nexttile
errorbar(stat_coeffs(:,1),stat_coeffs(:,11), 1.96*se(:,9),'Linewidth',2)
% ylim([-0.1 0.2]);
% yticks([-0.1:0.15:0.2]);
ylabel('beta9', 'FontSize', 16);
set(gca, 'FontSize', 16);

nexttile
errorbar(stat_coeffs(:,1),stat_coeffs(:,12), 1.96*se(:,9),'Linewidth',2)
% ylim([-0.1 0.2]);
% yticks([-0.1:0.15:0.2]);
ylabel('m', 'FontSize', 16);
set(gca, 'FontSize', 16);



xlabel('factor f', 'FontSize', 16);


%% All plots together
% close all;

stat_coeffs1 = [0.50 0.11182246 0.03953073 0.01676750
 0.75 0.10293267 0.03046189 0.02535496
 1.00 0.08393694 0.02928214 0.03743779
 1.25 0.07848794 0.02809078 0.03357206
 1.50 0.06857939 0.03068781 0.03346642
 1.75 0.07142972 0.03529504 0.02930434
 2.00 0.06652295 0.03055866 0.02632645
 2.25 0.06575985 0.02577940 0.03000351
2.50 0.06295578 0.02079898 0.02927699]; 
                
se1=[0.50 0.014507103 0.021831653 0.022858512
 0.75 0.014807263 0.015893727 0.016406889
 1.00 0.009857731 0.011610977 0.011702933
 1.25 0.006791166 0.010077797 0.010020327
 1.50 0.005689854 0.008386944 0.008196155
 1.75 0.006319517 0.008008314 0.007902154
 2.00 0.004810881 0.006178974 0.006161645
 2.25 0.004602277 0.005712806 0.005641207
 2.50 0.003498265 0.004920692 0.004789705];

stat_coeffs2 = [0.50 0.6662652 -0.19876567
 0.75 0.7695995 -0.06706759
 1.00 1.2005978 -0.34666249
 1.25 1.0962231 -0.32444054
 1.50 1.3586872 -0.43259823
 1.75 1.1208803 -0.35272336
 2.00 0.9421734 -0.28598780
 2.25 1.0609179 -0.32913737
 2.50 1.0825623 -0.33189334]; 
                
se2=[0.50 0.4189685 0.15629342
 0.75 0.4725260 0.11302286
 1.00 0.3907402 0.14550731
 1.25 0.2705300 0.09746294
 1.50 0.2351866 0.08495744
 1.75 0.1952477 0.06990574
 2.00 0.1728430 0.06114378
 2.25 0.1593170 0.05612981
2.50 0.1477494 0.05169772];

stat_coeffs = [0.50 0.5215187  0.088008389  0.075162157  0.12922029 -0.03733396  0.0334000439 0.1590100  0.13783400  0.21975286  0.1899696 -0.3429228
 0.75 0.5667550 -0.033082402  0.046617738  0.06127693 -0.08008204 -0.0304240110 0.1447900  0.02202884  0.13046267  0.2200257 -0.3671732
 1.00 0.5767402 -0.096769287  0.109207176  0.03669163  0.05987360  0.0257349520 0.1323769  0.11141997  0.15259599  0.2500383 -0.3120457
 1.25 0.6307618 -0.063221538  0.127617786 -0.01989329  0.15986109  0.0261864343 0.1389188  0.14832330  0.15611857  0.2570218 -0.2695738
 1.50 0.6617512 -0.045383590  0.141589797  0.04418134  0.13968630  0.0303646441 0.1351334  0.11207632  0.17086640  0.2647101 -0.2579203
 1.75 0.6977121 -0.028134476  0.145631697  0.04728481  0.13519579  0.0216562230 0.1150548  0.09148304  0.16276649  0.2535587 -0.2324182
 2.00 0.7385453 -0.033330984  0.131910214  0.04378861  0.12154910  0.0141067667 0.1135403  0.07719256  0.16639565  0.2068444 -0.2015783
 2.25 0.7361755  0.012570767  0.137523576  0.08448787  0.11589233  0.0004664714 0.1286706  0.07665992  0.16326052  0.2042729 -0.1964924
 2.50 0.7326976  0.009954004  0.127343564  0.12191962  0.13084755 -0.0007414156 0.1431801  0.06564761  0.15902178  0.2044068 -0.2030852]; 
                
se=[0.50 0.10880598 0.11847273 0.09204863 0.11032108 0.14586400 0.07506045 0.09623163 0.09069046 0.08628638  0.12888839  0.06852010
 0.75 0.09713988 0.08116217 0.06546713 0.09288536 0.09053062 0.05614813 0.06953104 0.06449325 0.05959469  0.08448186  0.04204110
 1.00 0.07370254 0.07796337 0.06433181 0.08802422 0.08735382 0.05378709 0.07011632 0.06271740 0.06026817  0.07752937  0.03704581
 1.25 0.07248413 0.06685673 0.05929133 0.08093820 0.07937894 0.05094857 0.06500654 0.05551237 0.05707269  0.07267735  0.03270149
 1.50 0.07479683 0.06301552 0.05526689 0.07159774 0.07548606 0.04701457 0.06080341 0.05126571 0.05120670  0.06967195  0.02902028
 1.75 0.07167339 0.05801947 0.05102242 0.06749068 0.06930903 0.04369036 0.05421695 0.04649112 0.04727463  0.06591714  0.02631399
 2.00 0.06442952 0.05747281 0.04865152 0.06296743 0.06596280 0.04173348 0.05391786 0.04484614 0.04492789  0.06179653  0.02406826
 2.25 0.06013833 0.05482826 0.04746519 0.05985924 0.06553642 0.04030312 0.05239847 0.04371346 0.04368711  0.05737484  0.02242822
 2.50 0.06148333 0.05252887 0.04632404 0.05730135 0.06096334 0.03904103 0.05082198 0.04202632 0.04192743  0.05725164  0.02175328];

figure;
keyboard;
% stretch down the figure window to get rid of the error
tiledlayout(9,2);

% Model 1
nexttile
errorbar(stat_coeffs1(:,1),stat_coeffs1(:,2), 1.96*se1(:,2),'Linewidth',2)
% ylim([-1.3 -0.8]);
% yticks([-1.3:0.25:-0.8]);
ylabel('alpha', 'FontSize', 16);
set(gca, 'FontSize', 16);
xlim([0 2.5]);
xticks(0:1:3);

nexttile
errorbar(stat_coeffs1(:,1),stat_coeffs1(:,3), 1.96*se1(:,3),'Linewidth',2)
% ylim([-1 -0.6]);
% yticks([-1:0.2:-0.6]);
ylabel('beta1', 'FontSize', 16);
set(gca, 'FontSize', 16);
xlim([0 2.5]);
xticks(0:1:3);

nexttile
errorbar(stat_coeffs1(:,1),stat_coeffs1(:,4), 1.96*se1(:,4),'Linewidth',2)
% ylim([-0.2 0.5]);
% yticks([-0.2:0.35:0.5]);
ylabel('beta2', 'FontSize', 16);
set(gca, 'FontSize', 16);
xlim([0 2.5]);
xticks(0:1:3);

nexttile

% Model 2
nexttile
errorbar(stat_coeffs2(:,1),stat_coeffs2(:,2), 1.96*se2(:,2),'Linewidth',2)
% ylim([-1.3 -0.8]);
% yticks([-1.3:0.25:-0.8]);
ylabel('alpha', 'FontSize', 16);
set(gca, 'FontSize', 16);
xlim([0 2.5]);
xticks(0:1:3);

nexttile
errorbar(stat_coeffs2(:,1),stat_coeffs2(:,3), 1.96*se2(:,3),'Linewidth',2)
% ylim([-1 -0.6]);
% yticks([-1:0.2:-0.6]);
ylabel('beta1', 'FontSize', 16);
set(gca, 'FontSize', 16);
xlim([0 2.5]);
xticks(0:1:3);

% Model 3
nexttile
errorbar(stat_coeffs(:,1),stat_coeffs(:,2), 1.96*se(:,2),'Linewidth',2)
% ylim([-1.3 -0.8]);
% yticks([-1.3:0.25:-0.8]);
ylabel('alpha', 'FontSize', 16);
set(gca, 'FontSize', 16);
xlim([0 2.5]);
xticks(0:1:3);

nexttile
errorbar(stat_coeffs(:,1),stat_coeffs(:,3), 1.96*se(:,3),'Linewidth',2)
% ylim([-1 -0.6]);
% yticks([-1:0.2:-0.6]);
ylabel('beta1', 'FontSize', 16);
set(gca, 'FontSize', 16);
xlim([0 2.5]);
xticks(0:1:3);

nexttile
errorbar(stat_coeffs(:,1),stat_coeffs(:,4), 1.96*se(:,4),'Linewidth',2)
% ylim([-0.2 0.5]);
% yticks([-0.2:0.35:0.5]);
ylabel('beta2', 'FontSize', 16);
set(gca, 'FontSize', 16);
xlim([0 2.5]);
xticks(0:1:3);

nexttile
errorbar(stat_coeffs(:,1),stat_coeffs(:,5), 1.96*se(:,5),'Linewidth',2)
% ylim([-0.1 0.2]);
% yticks([-0.1:0.15:0.2]);
ylabel('beta3', 'FontSize', 16);
set(gca, 'FontSize', 16);
xlim([0 2.5]);
xticks(0:1:3);

nexttile
errorbar(stat_coeffs(:,1),stat_coeffs(:,6), 1.96*se(:,6),'Linewidth',2)
% ylim([0.1 0.3]);
% yticks([0.1 0.2 0.3]);
ylabel('beta4', 'FontSize', 16);
set(gca, 'FontSize', 16);
xlim([0 2.5]);
xticks(0:1:3);

nexttile
errorbar(stat_coeffs(:,1),stat_coeffs(:,7), 1.96*se(:,7),'Linewidth',2)
% ylim([-0.6 0]);
% yticks([-0.6:0.3:0]);
ylabel('beta5', 'FontSize', 16);
set(gca, 'FontSize', 16);
xlim([0 2.5]);
xticks(0:1:3);

nexttile
errorbar(stat_coeffs(:,1),stat_coeffs(:,8), 1.96*se(:,8),'Linewidth',2)
% ylim([-0.4 0]);
% yticks([-0.4:0.2:0]);
ylabel('beta6', 'FontSize', 16);
set(gca, 'FontSize', 16);
xlim([0 2.5]);
xticks(0:1:3);

nexttile
errorbar(stat_coeffs(:,1),stat_coeffs(:,9), 1.96*se(:,9),'Linewidth',2)
% ylim([-0.1 0.2]);
% yticks([-0.1:0.15:0.2]);
ylabel('beta7', 'FontSize', 16);
set(gca, 'FontSize', 16);
xlim([0 2.5]);
xticks(0:1:3);

nexttile
errorbar(stat_coeffs(:,1),stat_coeffs(:,10), 1.96*se(:,9),'Linewidth',2)
% ylim([-0.1 0.2]);
% yticks([-0.1:0.15:0.2]);
ylabel('beta8', 'FontSize', 16);
set(gca, 'FontSize', 16);
xlim([0 2.5]);
xticks(0:1:3);

nexttile
errorbar(stat_coeffs(:,1),stat_coeffs(:,11), 1.96*se(:,9),'Linewidth',2)
% ylim([-0.1 0.2]);
% yticks([-0.1:0.15:0.2]);
ylabel('beta9', 'FontSize', 16);
set(gca, 'FontSize', 16);
xlim([0 2.5]);
xticks(0:1:3);

nexttile
errorbar(stat_coeffs(:,1),stat_coeffs(:,12), 1.96*se(:,9),'Linewidth',2)
% ylim([-0.1 0.2]);
% yticks([-0.1:0.15:0.2]);
ylabel('m', 'FontSize', 16);
set(gca, 'FontSize', 16);

xlim([0 2.5]);
xticks(0:1:3);
xlabel('factor f', 'FontSize', 16);